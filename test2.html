<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Fingerprint Inspector</title>
  <script src="fingerprint2.js"></script>
  <style>
    /* ... (оставьте стили без изменений) ... */
  </style>
</head>
<body>
  <h1>Fingerprint Inspector</h1>
  <div id="table-container">Загрузка отпечатков...</div>

  <script>
    // Функция для сокращения длинных хешей
    function truncateHash(hash, maxLength = 50) {
      if (!hash) return 'N/A';
      if (hash.length <= maxLength) return hash;
      return `${hash.substring(0, maxLength)}...`;
    }

    window.addEventListener('load', function () {
      setTimeout(function () {
        Fingerprint2.get(function (components) {
          const table = document.createElement('table');
          const thead = document.createElement('thead');
          const tbody = document.createElement('tbody');

          thead.innerHTML = `
            <tr>
              <th>Параметр</th>
              <th>Значение</th>
              <th>Хеш (MD5)</th>
            </tr>
          `;

          const HIGHLIGHT_KEYS = ['canvas', 'webgl', 'webglVendorAndRenderer', 'audio'];

          components.forEach(function (component) {
            const tr = document.createElement('tr');
            if (HIGHLIGHT_KEYS.includes(component.key)) {
              tr.classList.add('highlight');
            }

            const tdKey = document.createElement('td');
            tdKey.textContent = component.key;

            const tdValue = document.createElement('td');
            let valueToDisplay = component.value;
            
            // Обработка Canvas и WebGL
            if (component.key === 'canvas' || component.key === 'webgl') {
              if (Array.isArray(component.value)) {
                valueToDisplay = component.value.join(' | ');
              }
            }
            
            tdValue.textContent = truncateHash(
              typeof valueToDisplay === 'string' ? valueToDisplay : JSON.stringify(valueToDisplay)
            );

            // Добавляем столбец с хешем
            const tdHash = document.createElement('td');
            if (component.value) {
              const str = typeof component.value === 'string' ? component.value : JSON.stringify(component.value);
              tdHash.textContent = truncateHash(md5(str)); // Используем MD5 для краткости
            } else {
              tdHash.textContent = 'N/A';
            }

            tr.appendChild(tdKey);
            tr.appendChild(tdValue);
            tr.appendChild(tdHash);
            tbody.appendChild(tr);
          });

          table.appendChild(thead);
          table.appendChild(tbody);
          document.getElementById('table-container').replaceChildren(table);
        });
      }, 500);
    });

    // Простая реализация MD5 (для демонстрации)
    function md5(str) {
      // В реальном проекте используйте библиотеку crypto-js или аналогичную
      return 'md5_' + str.split('').reduce((acc, char) => {
        return acc + char.charCodeAt(0).toString(16);
      }, '').slice(0, 32);
    }
  </script>
</body>
</html>